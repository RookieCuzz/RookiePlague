| 策划人 | 修订时间   | 修改内容 |
| ------ | ---------- | -------- |
| Cuzz   | 2025/12/08 | 无       |

# 简介

## 玩法简介

1.当某个动物所处区块中,特定种类的动物数量超过上限,则有一定几率(公式可配置)染上瘟疫.

2.瘟疫会使得动物不断流血,直到只剩一滴血,若长时间(时间可配置)未被治疗,直接死亡,并生成一具尸体.

3.一滴血感染瘟疫的动物无法繁殖,玩家需要通过药剂治疗动物

4.每种动物的繁殖次数有上限.

## 设计目的

1.调控服务器的动物数量,提高服务器tps和降低带宽消耗

2.联动粘液科技玩法

# 功能说明

## 染疫几率公式

- 区块内同类型怪物数量
- 天气
- 服务器玩家在线数量
- 生物群系
- 当前区块已经染病的动物数量
- ...

<img src="./assests/参考公式.png" alt="合成配方" style="zoom: 160%;" />





## 动物染疫标识

<img src="./assests/感染标识.png" alt="合成配方" style="zoom: 160%;" />

## 动物无法繁殖标识

<img src="./assests/无法繁育标识.png" alt="合成配方" style="zoom: 160%;" />



## 死亡尸体

**大型动物尸体(牛,猪,马等等)**

<img src="./assests/骨架.png" alt="合成配方" style="zoom: 160%;" />

**小型动物尸体(鸡,兔,等等)**

<img src="./assests/腐肉.png" alt="合成配方" style="zoom: 160%;" />

# 数值设计

## 染疫概率公式

染疫概率支持PlaceholderAPI变量，综合考虑以下因素：

```
染疫概率 = 基础概率 × 物种因子 × 数量系数 × 天气系数 × 生物群系系数 × 在线人数系数

其中：
- 数量系数 = (区块内同类动物数量 / 区块上限) ^ 2
- 天气系数：晴天 1.0，雨天 1.2，雷暴 1.5
- 生物群系系数：根据不同生物群系调整（可配置）
- 在线人数系数 = 1 + (在线人数 / 100) × 0.1
```

## 可配置的数值变量

- 特定动物的物种因子
- 特定动物的区块上限
- 瘟疫致死时间
- 尸体生成概率
- 最大繁殖次数
- 基础染疫概率
- 天气系数配置
- 生物群系系数配置

## 配置模板说明

配置表采用 Excel 格式，包含以下字段：

| 字段名 | 类型 | 分组 | 说明 |
|--------|------|------|------|
| id | int | c,s | 动物配置ID（唯一标识） |
| type | string | c,s  | 动物类型（对应原版动物类型，如COW、PIG、CHICKEN等） |
| desc | string | c,s  | 动物描述（中文名称） |
| speciesFactor | float | c,s  | 物种因子（影响染疫概率计算的系数） |
| chunkLimit | int | c,s  | 区块上限（同类动物在单个区块内的数量上限） |
| corpseDropRate | int | c,s  | 死亡生成尸体概率（百分比，如80表示80%） |
| corpseModelId | string | c,s | 尸体的CE模型id（对应CustomEntity插件的模型ID） |
| maxBreedTimes | int | c,s  | 最大繁殖次数（每只动物的繁殖次数上限） |
| plagueDeathTime | int | c,s  | 瘟疫致死时间（未治疗情况下从感染到死亡的时间，单位：秒） |

**分组说明：**
- `c`: 客户端需要的数据
- `s`: 服务端需要的数据
- `c,s`: 客户端和服务端都需要的数据

## 配置示例

以下是部分动物的配置示例：

### 牛 (COW)
- **ID**: 1
- **物种因子**: 1.0
- **区块上限**: 15只
- **尸体生成概率**: 80%
- **最大繁殖次数**: 5次
- **瘟疫致死时间**: 300秒（5分钟）
- **尸体模型ID**: animal_corpse_large

### 猪 (PIG)
- **ID**: 2
- **物种因子**: 1.1
- **区块上限**: 12只
- **尸体生成概率**: 75%
- **最大繁殖次数**: 6次
- **瘟疫致死时间**: 280秒
- **尸体模型ID**: animal_corpse_large

### 羊 (SHEEP)
- **ID**: 3
- **物种因子**: 0.9
- **区块上限**: 18只
- **尸体生成概率**: 70%
- **最大繁殖次数**: 5次
- **瘟疫致死时间**: 320秒
- **尸体模型ID**: animal_corpse_large

### 鸡 (CHICKEN)
- **ID**: 4
- **物种因子**: 1.3
- **区块上限**: 20只
- **尸体生成概率**: 60%
- **最大繁殖次数**: 8次
- **瘟疫致死时间**: 240秒（4分钟）
- **尸体模型ID**: animal_corpse_small

### 兔子 (RABBIT)
- **ID**: 5
- **物种因子**: 1.2
- **区块上限**: 15只
- **尸体生成概率**: 50%
- **最大繁殖次数**: 10次
- **瘟疫致死时间**: 200秒
- **尸体模型ID**: animal_corpse_small

## 数值平衡说明

### 物种因子 (speciesFactor)
- **繁殖快的动物** (鸡、兔): 1.2-1.4（更容易染疫）
- **普通动物** (牛、羊): 0.9-1.1（正常染疫率）
- **繁殖慢的动物** (马、骡): 0.7-0.9（较低染疫率）

### 区块上限 (chunkLimit)
- **小型动物** (鸡、兔): 15-20只
- **中型动物** (猪、羊): 12-18只
- **大型动物** (牛、马): 10-15只

### 最大繁殖次数 (maxBreedTimes)
- **小型动物**: 8-10次
- **中型动物**: 5-7次
- **大型动物**: 4-6次

### 瘟疫致死时间 (plagueDeathTime)
- **快速致死** (鸡、兔): 180-240秒（3-4分钟）
- **中等致死** (猪、羊): 280-320秒（4.5-5.5分钟）
- **缓慢致死** (牛、马): 300-360秒（5-6分钟）

### 尸体生成概率 (corpseDropRate)
- **小型动物**: 50-60%（尸体较小，不易保留）
- **中型动物**: 70-80%（正常概率）
- **大型动物**: 80-90%（尸体明显，高概率生成）

## 配置调整建议

1. **服务器性能优化**：如果服务器TPS较低，可以降低区块上限和最大繁殖次数
2. **玩家体验平衡**：瘟疫致死时间建议不少于3分钟，给予玩家足够的反应时间
3. **经济平衡**：根据服务器内动物产品的价值调整繁殖次数和染疫概率
4. **视觉效果**：尸体生成概率不宜过高，避免地图上尸体过多影响美观
5. **联动平衡**：治疗药剂的成本应与动物价值相匹配，避免玩家放弃治疗

